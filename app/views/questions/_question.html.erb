<!-- Template for rendering a question -->
<div class="row question" style="margin-top: 0.5em;">
  <div class="col-xs-12">
    <!-- Question's topics -->
    <p class="text-muted">
      In
      <i>
        <% question.topics.each do |topic| %>
          <%= link_to topic, questions_path(:topic => topic) %>
        <% end %>
      </i>
      - <%= question.updated_at.strftime('%-d %B, %Y') %>
    </p>

    <!-- Hidden field for question content -->
    <input type="text" id="question_content<%= question.id %>" value="<%= question.content %>" hidden>

    <!-- Question's header -->
    <div class="row">
      <!-- Question's content -->
      <div class="col-xs-9 question-content" >
        <%= link_to question.content, question_path(:id => question.id) %>
      </div>

      <!-- Question edit and delete buttons -->
      <div class="col-xs-3">
        <% if user_signed_in? && question.user == current_user %>
          <a id="edit_question<%= question.id %>" class="btn btn-default">edit</a>
          <%= link_to 'delete', question_path(:id => question.id), class: 'btn btn-default', method: :delete, data: { confirm: 'Are you sure?'} %>
        <% end %>
      </div>
    </div>

    <% if full == true %>
      <!-- Question's owner name -->
      <div class="row">
        <div class="col-xs-12">
          <% if question.anonymous == false %>
            <p>Posted by <%= link_to question.user.name, public_profile_path(:id => question.user.id) %>,<i> <%= (Time.now.to_date - question.created_at.to_date).to_i %> day(s) ago</i></p>
          <% else %>
            <p>Posted by Anonymous</p>
          <% end %>
        </div>
      </div>
      
      <% if !question.image.nil? && question.image.length != 0 %>
        <img src="<%= question.image %>" class="img img-responsive">
        <br/>
      <% end %><br>
  
      <div class="question-details" style="margin-top: -1.5em;">
        <p id="question_detail<%= question.id %>"><%= question.detail %></p>
      </div>
  
      <!-- Bottom buttons -->
      <div class="row">
        <div class="col-xs-9">
          <% if user_signed_in? %>
            <!-- Bottom left buttons -->
            <button id="answerQ<%= question.id %>" class="btn btn-default">Answer | <%= question.answers.length %></button>
       
            <% if !current_user.following.include? question.id %>
              <button id="follow<%= question.id %>" class="btn btn-default">Follow</button>
            <% else %>
              <button class="btn btn-default following" style="color: blue;">Following</button>
            <% end %>
          <% else %>
            <div class="btn btn-default" data-toggle="modal" data-target="#signInModal">Answer | <%= question.answers.length %></div>
            <div class="btn btn-default" data-toggle="modal" data-target="#signInModal">Follow</div>
          <% end %>
        </div>
        <!-- Bottom right buttons -->
        <div class="col-xs-3" style="margin-top: 0.8em;">
          <%= social_share_button_tag(question.content) %>
        </div>
      </div>
    <% end %>

    <% if !answers.empty? %>
      <div class="col-xs-12" style="margin-bottom: -1.5em; <%= full == true ? 'margin-top: -1em;' : '' %>">
        <!-- Rendering answers -->
        <% if full == true %>
          <hr>
        
          <% answers.each do |answer| %>
            <%= render 'questions/answer', :answer => answer %>
          <% end %>
        <% else %>
          <%= render 'questions/answer', :answer => answers.sort_by {|a| a.upvotes }.reverse[0] %>
        <% end %>
      </div>
    <% else %>
      <% if full == false %>
        <p class='text-muted'>Be the first to answer</p>
      <% end %>
    <% end %>
  </div>
</div>

<hr class="question-hr">